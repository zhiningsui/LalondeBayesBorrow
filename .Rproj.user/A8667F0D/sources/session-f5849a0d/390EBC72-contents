#' Obtain Operating Characteristics (OC)
#'
#' This function calculates the operating characteristics (OC) by computing the proportion of decisions made based on the posterior probability and the credible interval from a set of decision results.
#' It combines these proportions with the provided settings data to return a comprehensive summary.
#'
#' @param settings A data frame. Contains the settings or parameters used in the simulations or trials.
#' @param decisions A data frame. Contains the decisions made in each simulation or trial, with columns for posterior probability-based decisions (`decision_pr`) and credible interval-based decisions (`decision_ci`).
#'
#' @return A data frame that includes the original settings along with the calculated proportions of decisions based on the posterior probability and credible interval. The output includes:
#'   - `proportion_pr`: Proportion of decisions made based on the posterior probability.
#'   - `proportion_ci`: Proportion of decisions made based on the credible interval.
#' @export
#'
#' @examples
#' # Example usage:
#' settings <- data.frame(setting1 = "A", setting2 = "B")
#' decisions <- data.frame(decision_pr = c("go", "no-go", "consider"), decision_ci = c("go", "no-go", "consider"))
#' obtain_OC(settings, decisions)
#'
#' @import dplyr
#' @import tidyr
obtain_OC <- function(settings, decisions){
  # Proportion of decisions made based on the posterior probability
  proportion_pr <- decisions %>%
    group_by(decision_pr) %>%
    summarise(count_pr = n(), .groups = 'drop') %>%
    complete(decision_pr = factor(levels(decision_pr)), fill = list(count_pr = 0)) %>%
    mutate(proportion_pr = count_pr / sum(count_pr, na.rm = TRUE))
  # Proportion of decisions made based on the credible interval
  proportion_ci <- decisions %>%
    group_by(decision_ci) %>%
    summarise(count_ci = n(), .groups = 'drop') %>%
    complete(decision_ci = factor(levels(decision_ci)), fill = list(count_ci = 0)) %>%
    mutate(proportion_ci = count_ci / sum(count_ci, na.rm = TRUE))

  OC <- cbind(settings, cbind(proportion_pr, proportion_ci))
  return(OC)
}
